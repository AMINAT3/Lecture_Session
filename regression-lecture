{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "24699f8e-333b-43d5-96f2-ee73324ee280",
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import matpl+tlib.pyplot as plt\n",
    "import pandas as pd\n",
    "import seaborn as sns\n",
    "%matplotlib inline "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "b4a22f98-a693-4586-aacb-1a32bc432486",
   "metadata": {},
   "outputs": [],
   "source": [
    "companies = pd.read_csv(\"C:\\\\Users\\\\Zachary_B\\\\Desktop\\\\dataset\\\\1000_Companies.csv\")\n",
    "X = companies.iloc[:, :-1].values\n",
    "Y = companies.iloc[:, 4].values"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "96f15c64-60f6-4e0a-b041-6101d74d6fab",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>R&amp;D Spend</th>\n",
       "      <th>Administration</th>\n",
       "      <th>Marketing Spend</th>\n",
       "      <th>State</th>\n",
       "      <th>Profit</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>165349.20</td>\n",
       "      <td>136897.80</td>\n",
       "      <td>471784.10</td>\n",
       "      <td>New York</td>\n",
       "      <td>192261.83</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>162597.70</td>\n",
       "      <td>151377.59</td>\n",
       "      <td>443898.53</td>\n",
       "      <td>California</td>\n",
       "      <td>191792.06</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>153441.51</td>\n",
       "      <td>101145.55</td>\n",
       "      <td>407934.54</td>\n",
       "      <td>Florida</td>\n",
       "      <td>191050.39</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>144372.41</td>\n",
       "      <td>118671.85</td>\n",
       "      <td>383199.62</td>\n",
       "      <td>New York</td>\n",
       "      <td>182901.99</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>142107.34</td>\n",
       "      <td>91391.77</td>\n",
       "      <td>366168.42</td>\n",
       "      <td>Florida</td>\n",
       "      <td>166187.94</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   R&D Spend  Administration  Marketing Spend       State     Profit\n",
       "0  165349.20       136897.80        471784.10    New York  192261.83\n",
       "1  162597.70       151377.59        443898.53  California  191792.06\n",
       "2  153441.51       101145.55        407934.54     Florida  191050.39\n",
       "3  144372.41       118671.85        383199.62    New York  182901.99\n",
       "4  142107.34        91391.77        366168.42     Florida  166187.94"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "companies.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "cd983aeb-2c8b-435b-8850-6f6a77781941",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<AxesSubplot:>"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "sns.heatmap(companies.corr())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "39b0eb90-b3e9-4a66-b9ba-ae336149b174",
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.preprocessing import LabelEncoder, OneHotEncoder\n",
    "from sklearn.compose import ColumnTransformer\n",
    "labelencoder = LabelEncoder()\n",
    "X[:, 3] = labelencoder.fit_transform(X[:, 3])\n",
    "\n",
    "ct = ColumnTransformer(\n",
    "    [('one_hot_encoder', OneHotEncoder(categories='auto'), [3])],   # The column numbers to be transformed (here is [3] but can be [0, 1, 3])\n",
    "    remainder='passthrough'                                         # Leave the rest of the columns untouched\n",
    ")\n",
    "X = ct.fit_transform(X)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "f9b7810c-eef3-415e-95de-b5e3c898f586",
   "metadata": {},
   "outputs": [],
   "source": [
    "X=X[:, 1:]"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f972a9b8-39d2-4aa7-bb4f-3af743ba0f40",
   "metadata": {},
   "source": [
    "### split into train and test datasets"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "4a229808-389a-4845-90a4-f357d4c1d05d",
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.model_selection import train_test_split\n",
    "X_train, X_test, y_train, y_test = train_test_split( X, y, test_size=0.2, random_state=0)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "40b930fa-e3cf-49ac-a629-865ffb25d25a",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "LinearRegression()"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from sklearn.linear_model import LinearRegression\n",
    "regressor = LinearRegression()\n",
    "regressor.fit(X_train, y_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "795cce7a-efbb-4878-a30f-466c4ba1fed3",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[ 89790.61532915  88427.07187361  94894.67836971 175680.86725611\n",
      "  83411.73042088 110571.90200074 132145.2293644   91473.37719686\n",
      " 164597.05380607  53222.826674    66950.19050989 150566.43987005\n",
      " 126915.20858596  59337.85971049 177513.91053062  75316.2814305\n",
      " 118248.14406603 164574.40699902 170937.2898107  182069.11645085\n",
      " 118845.03252689  85669.95112228 180992.59396144  84145.08220144\n",
      " 105005.83769214 101233.56772746  53831.0766909   56881.41475223\n",
      "  68896.39346904 210040.00765884 120778.72270894 111724.87157654\n",
      " 101487.90541517 137959.02649624  63969.95996743 108857.91214126\n",
      " 186014.72531989 171442.64130748 174644.26529205 117671.49128195\n",
      "  96731.37857433 165452.2577941  107724.34331255  50194.54176912\n",
      " 116513.89532179  58632.4898682  158416.4682761   78541.48521609\n",
      " 159727.66671744 131137.87699644 184880.70924517 174609.08266881\n",
      "  93745.66352058  78341.13383417 180745.9043908   84461.61490552\n",
      " 142900.90602903 170618.44098397  84365.09530838 105307.3716218\n",
      " 141660.07290787  52527.34340441 141842.96264161 139176.27973195\n",
      "  98294.52669666 113586.86790969 126754.21895489 152135.51985562\n",
      "  58864.51658954 174285.5736113  124624.04380784 169065.77658979\n",
      "  91279.33198209 156170.37268963  84307.26579365  77877.75223096\n",
      " 120414.02421346  93380.44273241 139020.62514121 143604.67103573\n",
      " 171148.30815369 140082.97050132 106369.71689747 155641.43851388\n",
      " 140030.10330037 110172.87893525  69672.98677564  88148.52068041\n",
      " 140133.59925093 148479.09537888 157916.63505257  58532.9486314\n",
      "  93707.3842239  112646.37475705  56556.1894366  107414.89996181\n",
      " 147352.80227753 152144.10104034 167808.11701784 118750.25230713\n",
      " 120763.27666701 139029.95295663 157527.9093412  121962.0621496\n",
      "  87091.32399736 104792.91384333  95335.22679185 178389.52287437\n",
      " 181942.63776382 109831.34945506 165254.03344097 167806.06491903\n",
      " 158002.44642544 174782.86900957 170196.77102699  52302.18161611\n",
      " 176938.1159579  104751.83583865  82710.31528805 138890.52767844\n",
      " 144274.74675425 161679.01836441 169662.05445896 120450.9231013\n",
      " 158880.70799547 110213.73252824 169674.51532367  60760.61300841\n",
      " 159036.99629068 158169.44286048 174511.70494476 156294.79927784\n",
      " 103714.37583212  85635.96237574 141603.54878757 165917.6915698\n",
      " 121182.03641977 170751.87883894 100505.77549411  82097.51033127\n",
      " 178643.18879843 101790.48384578  70507.40958621  90250.04230088\n",
      "  61247.49962679  68912.1753452   72775.81613475 176914.08873125\n",
      "  89704.69244931 129209.43730015  92672.90938382  88133.59175043\n",
      " 172836.33021619  60893.62070013 169015.89446011 166450.24453205\n",
      " 165425.54476416 102170.5169499  181594.57928217  73702.57942561\n",
      "  91267.42979668 135791.54160195  64922.80257299  71775.70235725\n",
      "  60603.91401515 184288.61041916 176286.69585946 158907.75687039\n",
      " 141359.32216439 154611.17928321  58549.58863232  90618.58407899\n",
      " 152885.51163925 168398.05223806  72485.36274539 116064.24350667\n",
      "  80087.80697208 149828.90896188 116806.9595737  130191.48845161\n",
      " 174534.42670329 293584.45948284 146270.83174789 150646.69178014\n",
      "  86107.47782247  69967.20842245  70096.78368773  69033.69170768\n",
      " 120666.75708064  89677.68014063 166824.27091663 125514.76626409\n",
      "  67209.67687466 140930.69427703 118544.30490695 165897.61905907\n",
      " 168655.48652553 147009.66805049 141396.22104147 109086.50634849]\n"
     ]
    }
   ],
   "source": [
    "y_pred = regressor.predict(X_test)\n",
    "print(y_pred)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "6f896717-784d-45d8-a3e0-64f9466ca4e3",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[-8.80536598e+02 -6.98169073e+02  5.25845857e-01  8.44390881e-01\n",
      "  1.07574255e-01]\n"
     ]
    }
   ],
   "source": [
    "print(regressor.coef_)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "17b858a5-2454-41db-923d-cde22eca092c",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "-51035.2297240395\n"
     ]
    }
   ],
   "source": [
    "print(regressor.intercept_)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "6803eef5-406b-4d25-9d84-87ef3ddaa585",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.9112695892268868"
      ]
     },
     "execution_count": 19,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from sklearn.metrics import r2_score\n",
    "r2_score(y_test, y_pred)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 50,
   "id": "0dcf303b-dd85-4dac-8897-0f9601530193",
   "metadata": {},
   "outputs": [
    {
     "ename": "ValueError",
     "evalue": "Unknown label type: 'continuous'",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mValueError\u001b[0m                                Traceback (most recent call last)",
      "\u001b[1;32m<ipython-input-50-e4ca016d3051>\u001b[0m in \u001b[0;36m<module>\u001b[1;34m\u001b[0m\n\u001b[0;32m      2\u001b[0m \u001b[1;32mfrom\u001b[0m \u001b[0msklearn\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mmodel_selection\u001b[0m \u001b[1;32mimport\u001b[0m \u001b[0mtrain_test_split\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m      3\u001b[0m \u001b[0mX_train\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mX_test\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0my_train\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0my_test\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mtrain_test_split\u001b[0m\u001b[1;33m(\u001b[0m \u001b[0mX\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0my\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mtest_size\u001b[0m\u001b[1;33m=\u001b[0m \u001b[1;36m0.2\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mrandom_state\u001b[0m \u001b[1;33m=\u001b[0m \u001b[1;36m42\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m----> 4\u001b[1;33m \u001b[0mmodel\u001b[0m\u001b[1;33m=\u001b[0m\u001b[0mLogisticRegression\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mfit\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mX_train\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0my_train\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m      5\u001b[0m \u001b[0mmodel\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mscore\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mX_test\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0my_test\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32m~\\anaconda3\\lib\\site-packages\\sklearn\\linear_model\\_logistic.py\u001b[0m in \u001b[0;36mfit\u001b[1;34m(self, X, y, sample_weight)\u001b[0m\n\u001b[0;32m   1345\u001b[0m                                    \u001b[0morder\u001b[0m\u001b[1;33m=\u001b[0m\u001b[1;34m\"C\"\u001b[0m\u001b[1;33m,\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   1346\u001b[0m                                    accept_large_sparse=solver != 'liblinear')\n\u001b[1;32m-> 1347\u001b[1;33m         \u001b[0mcheck_classification_targets\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0my\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m   1348\u001b[0m         \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mclasses_\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mnp\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0munique\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0my\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   1349\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32m~\\anaconda3\\lib\\site-packages\\sklearn\\utils\\multiclass.py\u001b[0m in \u001b[0;36mcheck_classification_targets\u001b[1;34m(y)\u001b[0m\n\u001b[0;32m    181\u001b[0m     if y_type not in ['binary', 'multiclass', 'multiclass-multioutput',\n\u001b[0;32m    182\u001b[0m                       'multilabel-indicator', 'multilabel-sequences']:\n\u001b[1;32m--> 183\u001b[1;33m         \u001b[1;32mraise\u001b[0m \u001b[0mValueError\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;34m\"Unknown label type: %r\"\u001b[0m \u001b[1;33m%\u001b[0m \u001b[0my_type\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m    184\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    185\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;31mValueError\u001b[0m: Unknown label type: 'continuous'"
     ]
    }
   ],
   "source": [
    "from sklearn.linear_model import LogisticRegression\n",
    "from sklearn.model_selection import train_test_split\n",
    "X_train, X_test, y_train, y_test = train_test_split( X, y, test_size= 0.2, random_state = 42)\n",
    "model=LogisticRegression().fit(X_train, y_train)\n",
    "model.score(X_test, y_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "06a8a03a-0f1e-4c91-ab70-4dbbdf1e28ea",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[125205.84519529 111437.73918787  91279.33198209 127096.60656199\n",
      " 161228.50841162  91350.55543994 154423.25221052 138890.52767844\n",
      "  88427.07187361  91046.78297451 167640.33748105 162961.89902895\n",
      " 104792.91384333 107868.8424115   91533.33375114 159459.93508661\n",
      " 116475.72744764 105005.83769214 120180.20637769 105307.3716218\n",
      "  75464.73516093 125514.24405584  64972.98397065  69990.82486339\n",
      " 170800.88337651 164116.92069281 178643.18879843 135791.54160195\n",
      " 121962.0621496  162189.18549754 145080.10516809 113768.89951651\n",
      " 165357.75381397 141386.78181427  64996.15307039  88727.74776079\n",
      "  82571.30079558  74066.0090929  117161.02487009 170705.63277644\n",
      "  60138.36881583  88607.16446596 121182.03641977 142356.97307887\n",
      " 169065.77658979 147082.49633963 152951.25058582 139020.62514121\n",
      " 142192.2151796   75037.05838922 114173.40718848  62311.11381186\n",
      " 171148.30815369 177513.91053062 105676.40941285  88133.59175043\n",
      " 179825.55868963 119711.28114399 121534.72129655  67718.53855043\n",
      " 119175.01877943  89704.69244931 182260.88664804  61168.1057624\n",
      " 179732.1356815  100101.71516334  65229.14933473  51015.75701168\n",
      "  83233.76495252 100734.14528965 101623.04014322 134222.79736617\n",
      " 129014.15582568 168029.17462573  95368.6932457  105846.78952569\n",
      " 100944.27182819  58135.3425085   65446.2522267  185838.47610535\n",
      " 165897.61905907  69357.20076519 160864.66796938 178194.73094446\n",
      "  97607.17728135 169823.37992425 318415.92213095  99630.61050232\n",
      " 141603.54878757  49977.02809467 104751.83583865  68455.21133168\n",
      "  53861.26360751  54225.55139957  65193.10858457 176159.80639747\n",
      " 112936.52878324  78439.8169419  101938.93764989 168398.05223806\n",
      " 127796.38038172 141359.32216439 164786.36120318 109654.13060664\n",
      " 107724.34331255 118750.25230713 118341.26772174 172949.07901992\n",
      " 155714.26672934 135706.58827157  78566.4819922  120778.72270894\n",
      " 103523.35225486 174175.73501178 166844.0075087   78341.13383417\n",
      "  74560.80505115  99266.65862678  91936.23659182 126543.12287765\n",
      "  57703.15220089 173211.21464325  85635.96237574 169821.7751774\n",
      "  99432.72199418 106925.43904389 167806.06491903 165952.87419305\n",
      "  80903.46275079 174701.75897256 162408.41534461 186482.06172345\n",
      " 131567.0455151   96086.59899509 100505.77549411  75316.2814305\n",
      " 130440.34162804 147009.66805049 115647.0819889  105304.34988909\n",
      "  94391.82233372 156170.37268963  88559.55736461 110154.52267834\n",
      "  67034.28571336  95073.91283515 153266.51437727  53146.04375015\n",
      " 170909.3416301  169426.07301739  52527.34340441 127244.2021655\n",
      "  89641.63930603 132629.39087521 150022.50691989 185489.55948603\n",
      " 101524.46845803 140224.0370926  158880.70799547  63764.75927162\n",
      " 183123.40290817 174534.42670329 181092.13519609 103549.0956509\n",
      "  77474.84930584 163701.59345847  94894.67836971 114360.99834251\n",
      " 124748.47031161 180992.59396144 173768.24217335  77968.37644666\n",
      " 139138.075376    86107.47782247 117947.9155308   91331.26611539\n",
      " 164793.56197905 158546.90158385 141975.9703301   72418.95213037\n",
      "  58532.9486314   57409.67717079 108075.64786491  54717.66155883\n",
      " 150690.00833135 174499.35549183  79651.02689183  54169.77397504\n",
      " 158907.75687039  81627.71113838  77209.80346755  63527.91970314\n",
      "  57626.78006168  94867.21871983  75107.31230837  63969.95996743\n",
      " 136578.43226267 118607.80530699 138331.44804953  73406.53000723]\n",
      "[-8.80536598e+02 -6.98169073e+02  5.25845857e-01  8.44390881e-01\n",
      "  1.07574255e-01]\n"
     ]
    }
   ],
   "source": [
    "y_pred = regressor.predict(X_test)\n",
    "print(y_pred)\n",
    "print(regressor.coef_)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "71cf8baa-06ff-49ca-ac7d-33c3cf574bd1",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "-51035.2297240395\n"
     ]
    }
   ],
   "source": [
    "print(regressor.intercept_)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "6d0f2b18-36f2-4d88-adfa-a31202342ff4",
   "metadata": {},
   "source": [
    "### over fiting "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "id": "2b35b28e-3c7e-4e21-a1a5-c7e3e360d6f7",
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.preprocessing import PolynomialFeatures"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 44,
   "id": "51725b73-1031-47b1-a3e3-4d94ef9733d8",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "<ipython-input-44-31b4330bbf9f>:8: FutureWarning: Using a non-tuple sequence for multidimensional indexing is deprecated; use `arr[tuple(seq)]` instead of `arr[seq]`. In the future this will be interpreted as an array index, `arr[np.array(seq)]`, which will result either in an error or a different result.\n",
      "  X_train_pr=pr.fit_transform(X_train[['horsepower']])\n"
     ]
    },
    {
     "ename": "IndexError",
     "evalue": "only integers, slices (`:`), ellipsis (`...`), numpy.newaxis (`None`) and integer or boolean arrays are valid indices",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mIndexError\u001b[0m                                Traceback (most recent call last)",
      "\u001b[1;32m<ipython-input-44-31b4330bbf9f>\u001b[0m in \u001b[0;36m<module>\u001b[1;34m\u001b[0m\n\u001b[0;32m      6\u001b[0m     \u001b[0mpr\u001b[0m\u001b[1;33m=\u001b[0m\u001b[0mPolynomialFeatures\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mdegree\u001b[0m\u001b[1;33m=\u001b[0m\u001b[0mn\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m      7\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m----> 8\u001b[1;33m     \u001b[0mX_train_pr\u001b[0m\u001b[1;33m=\u001b[0m\u001b[0mpr\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mfit_transform\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mX_train\u001b[0m\u001b[1;33m[\u001b[0m\u001b[1;33m[\u001b[0m\u001b[1;34m'horsepower'\u001b[0m\u001b[1;33m]\u001b[0m\u001b[1;33m]\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m      9\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     10\u001b[0m     \u001b[0mX_test_pr\u001b[0m\u001b[1;33m=\u001b[0m\u001b[0mpr\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mfit_transform\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mX_test\u001b[0m\u001b[1;33m[\u001b[0m\u001b[1;33m[\u001b[0m\u001b[1;34m'horsepower'\u001b[0m\u001b[1;33m]\u001b[0m\u001b[1;33m]\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;31mIndexError\u001b[0m: only integers, slices (`:`), ellipsis (`...`), numpy.newaxis (`None`) and integer or boolean arrays are valid indices"
     ]
    }
   ],
   "source": [
    "Rsqu_test=[]\n",
    "\n",
    "order=[1,2,3,4]\n",
    "\n",
    "for n in order:\n",
    "    pr=PolynomialFeatures(degree=n)\n",
    "\n",
    "    X_train_pr=pr.fit_transform(X_train[['horsepower']])\n",
    "\n",
    "    X_test_pr=pr.fit_transform(X_test[['horsepower']])\n",
    "\n",
    "    lr.fit(X_train_pr,y_train)\n",
    "\n",
    "    Rsqu_test.append(lr.score(X_test_pr,y_test))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "7cd713ea-e5eb-41ea-b470-57c2f2a8a937",
   "metadata": {},
   "outputs": [
    {
     "ename": "SyntaxError",
     "evalue": "unexpected character after line continuation character (<ipython-input-24-95fbcd8762fd>, line 1)",
     "output_type": "error",
     "traceback": [
      "\u001b[1;36m  File \u001b[1;32m\"<ipython-input-24-95fbcd8762fd>\"\u001b[1;36m, line \u001b[1;32m1\u001b[0m\n\u001b[1;33m    X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2,\\ random_state=42)\u001b[0m\n\u001b[1;37m                                                                                              ^\u001b[0m\n\u001b[1;31mSyntaxError\u001b[0m\u001b[1;31m:\u001b[0m unexpected character after line continuation character\n"
     ]
    }
   ],
   "source": [
    "X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2,\\ random_state=42)\n",
    "model=LogisticRegression().fit(X_train, y_train)\n",
    "model.score(X_test, y_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "id": "078d0fd0-d8ac-4b51-b4f0-86f1faec6c36",
   "metadata": {},
   "outputs": [
    {
     "ename": "ValueError",
     "evalue": "continuous is not supported",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mValueError\u001b[0m                                Traceback (most recent call last)",
      "\u001b[1;32m<ipython-input-33-e1399fb6d20e>\u001b[0m in \u001b[0;36m<module>\u001b[1;34m\u001b[0m\n\u001b[0;32m      2\u001b[0m \u001b[0mdummy\u001b[0m\u001b[1;33m=\u001b[0m\u001b[0mDummyClassifier\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mstrategy\u001b[0m\u001b[1;33m=\u001b[0m\u001b[1;34m'most_frequent'\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mrandom_state\u001b[0m\u001b[1;33m=\u001b[0m\u001b[1;36m42\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m      3\u001b[0m \u001b[0mdummy\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mfit\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mX_train\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0my_train\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m----> 4\u001b[1;33m \u001b[0mdummy\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mscore\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mX_test\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0my_test\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m",
      "\u001b[1;32m~\\anaconda3\\lib\\site-packages\\sklearn\\dummy.py\u001b[0m in \u001b[0;36mscore\u001b[1;34m(self, X, y, sample_weight)\u001b[0m\n\u001b[0;32m    386\u001b[0m         \u001b[1;32mif\u001b[0m \u001b[0mX\u001b[0m \u001b[1;32mis\u001b[0m \u001b[1;32mNone\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    387\u001b[0m             \u001b[0mX\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mnp\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mzeros\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mshape\u001b[0m\u001b[1;33m=\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mlen\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0my\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m,\u001b[0m \u001b[1;36m1\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m--> 388\u001b[1;33m         \u001b[1;32mreturn\u001b[0m \u001b[0msuper\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mscore\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mX\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0my\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0msample_weight\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m    389\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    390\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32m~\\anaconda3\\lib\\site-packages\\sklearn\\base.py\u001b[0m in \u001b[0;36mscore\u001b[1;34m(self, X, y, sample_weight)\u001b[0m\n\u001b[0;32m    498\u001b[0m         \"\"\"\n\u001b[0;32m    499\u001b[0m         \u001b[1;32mfrom\u001b[0m \u001b[1;33m.\u001b[0m\u001b[0mmetrics\u001b[0m \u001b[1;32mimport\u001b[0m \u001b[0maccuracy_score\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m--> 500\u001b[1;33m         \u001b[1;32mreturn\u001b[0m \u001b[0maccuracy_score\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0my\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mpredict\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mX\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0msample_weight\u001b[0m\u001b[1;33m=\u001b[0m\u001b[0msample_weight\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m    501\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    502\u001b[0m     \u001b[1;32mdef\u001b[0m \u001b[0m_more_tags\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mself\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32m~\\anaconda3\\lib\\site-packages\\sklearn\\utils\\validation.py\u001b[0m in \u001b[0;36minner_f\u001b[1;34m(*args, **kwargs)\u001b[0m\n\u001b[0;32m     61\u001b[0m             \u001b[0mextra_args\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mlen\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0margs\u001b[0m\u001b[1;33m)\u001b[0m \u001b[1;33m-\u001b[0m \u001b[0mlen\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mall_args\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     62\u001b[0m             \u001b[1;32mif\u001b[0m \u001b[0mextra_args\u001b[0m \u001b[1;33m<=\u001b[0m \u001b[1;36m0\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m---> 63\u001b[1;33m                 \u001b[1;32mreturn\u001b[0m \u001b[0mf\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;33m*\u001b[0m\u001b[0margs\u001b[0m\u001b[1;33m,\u001b[0m \u001b[1;33m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m     64\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     65\u001b[0m             \u001b[1;31m# extra_args > 0\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32m~\\anaconda3\\lib\\site-packages\\sklearn\\metrics\\_classification.py\u001b[0m in \u001b[0;36maccuracy_score\u001b[1;34m(y_true, y_pred, normalize, sample_weight)\u001b[0m\n\u001b[0;32m    200\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    201\u001b[0m     \u001b[1;31m# Compute accuracy for each possible representation\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m--> 202\u001b[1;33m     \u001b[0my_type\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0my_true\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0my_pred\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0m_check_targets\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0my_true\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0my_pred\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m    203\u001b[0m     \u001b[0mcheck_consistent_length\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0my_true\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0my_pred\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0msample_weight\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    204\u001b[0m     \u001b[1;32mif\u001b[0m \u001b[0my_type\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mstartswith\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;34m'multilabel'\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32m~\\anaconda3\\lib\\site-packages\\sklearn\\metrics\\_classification.py\u001b[0m in \u001b[0;36m_check_targets\u001b[1;34m(y_true, y_pred)\u001b[0m\n\u001b[0;32m     98\u001b[0m     \u001b[1;31m# No metrics support \"multiclass-multioutput\" format\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m     99\u001b[0m     \u001b[1;32mif\u001b[0m \u001b[1;33m(\u001b[0m\u001b[0my_type\u001b[0m \u001b[1;32mnot\u001b[0m \u001b[1;32min\u001b[0m \u001b[1;33m[\u001b[0m\u001b[1;34m\"binary\"\u001b[0m\u001b[1;33m,\u001b[0m \u001b[1;34m\"multiclass\"\u001b[0m\u001b[1;33m,\u001b[0m \u001b[1;34m\"multilabel-indicator\"\u001b[0m\u001b[1;33m]\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m--> 100\u001b[1;33m         \u001b[1;32mraise\u001b[0m \u001b[0mValueError\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;34m\"{0} is not supported\"\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mformat\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0my_type\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m    101\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    102\u001b[0m     \u001b[1;32mif\u001b[0m \u001b[0my_type\u001b[0m \u001b[1;32min\u001b[0m \u001b[1;33m[\u001b[0m\u001b[1;34m\"binary\"\u001b[0m\u001b[1;33m,\u001b[0m \u001b[1;34m\"multiclass\"\u001b[0m\u001b[1;33m]\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;31mValueError\u001b[0m: continuous is not supported"
     ]
    }
   ],
   "source": [
    "from sklearn.dummy import DummyClassifier\n",
    "dummy=DummyClassifier(strategy='most_frequent', random_state=42)\n",
    "dummy.fit(X_train, y_train)\n",
    "dummy.score(X_test, y_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 47,
   "id": "9e6d1389-729d-40de-940e-eb4e1bcd0eb7",
   "metadata": {},
   "outputs": [
    {
     "ename": "ValueError",
     "evalue": "Unknown label type: 'continuous'",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mValueError\u001b[0m                                Traceback (most recent call last)",
      "\u001b[1;32m<ipython-input-47-1e13a7f129a9>\u001b[0m in \u001b[0;36m<module>\u001b[1;34m\u001b[0m\n\u001b[0;32m      1\u001b[0m \u001b[1;32mfrom\u001b[0m \u001b[0msklearn\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mensemble\u001b[0m \u001b[1;32mimport\u001b[0m \u001b[0mRandomForestClassifier\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m----> 2\u001b[1;33m \u001b[0mmodel\u001b[0m\u001b[1;33m=\u001b[0m\u001b[0mRandomForestClassifier\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mrandom_state\u001b[0m\u001b[1;33m=\u001b[0m\u001b[1;36m42\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mfit\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mX_train\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0my_train\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m      3\u001b[0m \u001b[0mmodel\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mscore\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mX_test\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0my_test\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32m~\\anaconda3\\lib\\site-packages\\sklearn\\ensemble\\_forest.py\u001b[0m in \u001b[0;36mfit\u001b[1;34m(self, X, y, sample_weight)\u001b[0m\n\u001b[0;32m    329\u001b[0m         \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mn_outputs_\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0my\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mshape\u001b[0m\u001b[1;33m[\u001b[0m\u001b[1;36m1\u001b[0m\u001b[1;33m]\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    330\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m--> 331\u001b[1;33m         \u001b[0my\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mexpanded_class_weight\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mself\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0m_validate_y_class_weight\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0my\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m    332\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    333\u001b[0m         \u001b[1;32mif\u001b[0m \u001b[0mgetattr\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0my\u001b[0m\u001b[1;33m,\u001b[0m \u001b[1;34m\"dtype\"\u001b[0m\u001b[1;33m,\u001b[0m \u001b[1;32mNone\u001b[0m\u001b[1;33m)\u001b[0m \u001b[1;33m!=\u001b[0m \u001b[0mDOUBLE\u001b[0m \u001b[1;32mor\u001b[0m \u001b[1;32mnot\u001b[0m \u001b[0my\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mflags\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mcontiguous\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32m~\\anaconda3\\lib\\site-packages\\sklearn\\ensemble\\_forest.py\u001b[0m in \u001b[0;36m_validate_y_class_weight\u001b[1;34m(self, y)\u001b[0m\n\u001b[0;32m    557\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    558\u001b[0m     \u001b[1;32mdef\u001b[0m \u001b[0m_validate_y_class_weight\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mself\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0my\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m--> 559\u001b[1;33m         \u001b[0mcheck_classification_targets\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0my\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m    560\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    561\u001b[0m         \u001b[0my\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mnp\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mcopy\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0my\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32m~\\anaconda3\\lib\\site-packages\\sklearn\\utils\\multiclass.py\u001b[0m in \u001b[0;36mcheck_classification_targets\u001b[1;34m(y)\u001b[0m\n\u001b[0;32m    181\u001b[0m     if y_type not in ['binary', 'multiclass', 'multiclass-multioutput',\n\u001b[0;32m    182\u001b[0m                       'multilabel-indicator', 'multilabel-sequences']:\n\u001b[1;32m--> 183\u001b[1;33m         \u001b[1;32mraise\u001b[0m \u001b[0mValueError\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;34m\"Unknown label type: %r\"\u001b[0m \u001b[1;33m%\u001b[0m \u001b[0my_type\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m    184\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    185\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;31mValueError\u001b[0m: Unknown label type: 'continuous'"
     ]
    }
   ],
   "source": [
    "from sklearn.ensemble import RandomForestClassifier\n",
    "model=RandomForestClassifier(random_state=42).fit(X_train, y_train)\n",
    "model.score(X_test, y_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 46,
   "id": "007df2fd-966e-45e1-bd17-a63b05503fc6",
   "metadata": {},
   "outputs": [
    {
     "ename": "NameError",
     "evalue": "name 'model' is not defined",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mNameError\u001b[0m                                 Traceback (most recent call last)",
      "\u001b[1;32m<ipython-input-46-3d90d7c7d305>\u001b[0m in \u001b[0;36m<module>\u001b[1;34m\u001b[0m\n\u001b[0;32m      1\u001b[0m \u001b[1;32mfrom\u001b[0m \u001b[0msklearn\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mmetrics\u001b[0m \u001b[1;32mimport\u001b[0m \u001b[0mconfusion_matrix\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m----> 2\u001b[1;33m \u001b[0mconfusion_matrix\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0my_test\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mmodel\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mpredict\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mX_test\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m",
      "\u001b[1;31mNameError\u001b[0m: name 'model' is not defined"
     ]
    }
   ],
   "source": [
    "from sklearn.metrics import confusion_matrix\n",
    "confusion_matrix(y_test, model.predict(X_test))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 48,
   "id": "8bbe6aa1-74d8-4887-98e8-7d2dbc1e12f4",
   "metadata": {},
   "outputs": [
    {
     "ename": "NameError",
     "evalue": "name 'model' is not defined",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mNameError\u001b[0m                                 Traceback (most recent call last)",
      "\u001b[1;32m<ipython-input-48-5ae8167acb61>\u001b[0m in \u001b[0;36m<module>\u001b[1;34m\u001b[0m\n\u001b[0;32m      1\u001b[0m \u001b[1;32mfrom\u001b[0m \u001b[0msklearn\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mmetrics\u001b[0m \u001b[1;32mimport\u001b[0m \u001b[0mprecision_score\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mrecall_score\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mf1_score\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m----> 2\u001b[1;33m \u001b[0mprint\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;34m'Precision: '\u001b[0m\u001b[1;33m,\u001b[0m\u001b[0mprecision_score\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0my_test\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mmodel\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mpredict\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mX_test\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m      3\u001b[0m \u001b[0mprint\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;34m'Recall: '\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mrecall_score\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0my_test\u001b[0m\u001b[1;33m,\u001b[0m\u001b[0mmodel\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mpredict\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mX_test\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m      4\u001b[0m \u001b[0mprint\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;34m'F1_score: '\u001b[0m\u001b[1;33m,\u001b[0m\u001b[0mf1_score\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0my_test\u001b[0m\u001b[1;33m,\u001b[0m\u001b[0mmodel\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mpredict\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mX_test\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;31mNameError\u001b[0m: name 'model' is not defined"
     ]
    }
   ],
   "source": [
    "from sklearn.metrics import precision_score, recall_score, f1_score\n",
    "print('Precision: ',precision_score(y_test, model.predict(X_test)))\n",
    "print('Recall: ', recall_score(y_test,model.predict(X_test)))\n",
    "print('F1_score: ',f1_score(y_test,model.predict(X_test)))\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "id": "6f604ae4-19bd-47a7-9d9c-1c4bcef014f7",
   "metadata": {},
   "outputs": [
    {
     "ename": "SyntaxError",
     "evalue": "unexpected character after line continuation character (<ipython-input-49-23f4538214c9>, line 6)",
     "output_type": "error",
     "traceback": [
      "\u001b[1;36m  File \u001b[1;32m\"<ipython-input-49-23f4538214c9>\"\u001b[1;36m, line \u001b[1;32m6\u001b[0m\n\u001b[1;33m    gs = GridSearchCV(estimator=model, peram_grid = param_grid,\\\u001b[0m\n\u001b[1;37m                                                                 ^\u001b[0m\n\u001b[1;31mSyntaxError\u001b[0m\u001b[1;31m:\u001b[0m unexpected character after line continuation character\n"
     ]
    }
   ],
   "source": [
    "from sklearn.model_selection import GridSearchCV\n",
    "param_grid ={\n",
    "    'n_estimator': [10, 200], \n",
    "    'max_features': ['auto', 'sqrt', 'log2', 0.5],\n",
    "}\n",
    "gs = GridSearchCV(estimator=model, peram_grid = param_grid,\\ \n",
    "                 scoring = 'recall', n_jobs =-1)\n",
    "gs.fit(x_train, y_train)\n",
    "recall_score(y_test, gs.best_estimatot_.predict(X_test))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fd576c7a-540e-469a-9c1e-7f77196bef4f",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.8"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
